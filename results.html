<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Search Results â€“ Islamic Google</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="background-gradient"></div>
  <div class="animated-lines"></div>
  <header>
    <h1>Islamic Google</h1>
    <p class="subtitle">Search Results</p>
  </header>
  <main>
    <section class="search-section">
      <form id="searchForm">
        <input type="text" id="searchQuery" placeholder="Search Islamic topics..." autocomplete="off" required>
        <button type="submit">Search</button>
      </form>
    </section>
    <section id="filters">
      <label>Filter by Category:</label>
      <select id="categoryFilter">
        <option value="">All</option>
        <option value="quran">Quran</option>
        <option value="hadith">Hadith</option>
        <option value="history">Islamic History</option>
        <option value="law">Islamic Law</option>
      </select>
    </section>
    <section id="results"></section>
    <section id="related-searches"></section>
  </main>
  <footer>
    <a href="index.html">Home</a> | <a href="about.html">About Us</a> | <a href="submit.html">Submit Content</a>
  </footer>
  <script>
    const API_KEY = "AIzaSyBPj8dveECyideRPYJTD8VbdLgTWfihyl0";
    const CX = "909f5c55f2a504e45";

    // Extract query from URL
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('q') || '';

    document.getElementById('searchQuery').value = query;

    // Search API call
    function fetchResults(q, filter = '') {
      let apiUrl = `https://www.googleapis.com/customsearch/v1?key=${API_KEY}&cx=${CX}&q=${encodeURIComponent(q)}`;
      if (filter) apiUrl += `+${filter}`;
      fetch(apiUrl)
        .then(res => res.json())
        .then(data => {
          // Show results
          const resultsDiv = document.getElementById('results');
          resultsDiv.innerHTML = '';
          if (data.items && data.items.length > 0) {
            data.items.forEach(item => {
              resultsDiv.innerHTML += `
                <div class="result-item">
                  <h3><a href="${item.link}" target="_blank">${item.title}</a></h3>
                  <p>${item.snippet}</p>
                  <span class="result-source">${item.displayLink}</span>
                </div>
              `;
            });
          } else {
            resultsDiv.innerHTML = '<p>No results found.</p>';
          }

          // Related searches
          const relatedDiv = document.getElementById('related-searches');
          if (data.queries && data.queries.nextPage) {
            relatedDiv.innerHTML = '<h4>Related Searches:</h4>';
            if (data.queries.request && data.queries.request[0].searchTerms) {
              const terms = [
                data.queries.request[0].searchTerms + ' meaning',
                data.queries.request[0].searchTerms + ' history',
                data.queries.request[0].searchTerms + ' scholars'
              ];
              relatedDiv.innerHTML += terms.map(t => `<a href="results.html?q=${encodeURIComponent(t)}">${t}</a>`).join(", ");
            }
          }
        });
    }

    fetchResults(query);

    document.getElementById('searchForm').onsubmit = function(e) {
      e.preventDefault();
      const newQuery = document.getElementById('searchQuery').value.trim();
      window.location.href = `results.html?q=${encodeURIComponent(newQuery)}`;
    };

    document.getElementById('categoryFilter').onchange = function() {
      fetchResults(query, this.value);
    };
  </script>
</body>
</html>
